# 鉴权

## Token

当用户第一次登录后，服务器生成一个token并将此token返回给客户端，以后客户端只需带上这个token前来请求数据即可，无需再次带上用户名和密码。

## JWT

JWT，JSON Web Tokens。服务器认证后，生成一个JSON对象返回到前端。前端在与服务器通信时，都要发送这个JSON对象，服务器完全只靠这个对象认定用户身份。

### 组成结构

* Header
* Payload
* Signature

即Header.Payload.Signature

#### Header

描述JWT元数据

```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```

#### Payload

Payload 部分也是一个 JSON 对象，用来存放实际需要传递的数据。JWT 规定了7个官方字段，供选用。

也可以自定义其他字段

#### Signature

Signature 部分是对前两部分的签名，防止数据篡改。

#### 串行化

使用Base64URL算法来串型化Header 和 Payload

### 使用方式

存储在cookie或localStorage中

### 特点

* 默认不加密，也可以在生成token后加密
* 不加密情况下，不推荐将秘密数据写入JWT
* JWT 不仅可以用于认证，也可以用于交换信息。有效使用 JWT，可以降低服务器查询数据库的次数
* JWT 的最大缺点是，由于服务器不保存 session 状态，因此无法在使用过程中废止某个 token，或者更改 token 的权限。也就是说，一旦 JWT 签发了，在到期之前就会始终有效，除非服务器部署额外的逻辑。
* JWT 本身包含了认证信息，一旦泄露，任何人都可以获得该令牌的所有权限。为了减少盗用，JWT 的有效期应该设置得比较短。对于一些比较重要的权限，使用时应该再次对用户进行认证。
* 为了减少盗用，JWT 不应该使用 HTTP 协议明码传输，要使用 HTTPS 协议传输。

## 参考资料

https://juejin.im/post/5c6e6063f265da2da53ec8f3#heading-8

http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html